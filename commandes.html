<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Commandes - Mini Alibaba</title>
  <link rel="stylesheet" href="style.css">
  <script type="module">
    import { supabase } from "./supabase.js";

    async function chargerCommandes() {
      const user = (await supabase.auth.getUser()).data.user;
      let { data, error } = await supabase.from("commandes").select(`
        id, quantite, created_at,
        produits (nom, prix)
      `).eq("acheteur_id", user.id);

      if (error) alert(error.message);
      else {
        const list = document.getElementById("liste-commandes");
        list.innerHTML = "";
        data.forEach(c => {
          list.innerHTML += `
            <div class="commande">
              <h3>${c.produits.nom}</h3>
              <p>Quantit√© : ${c.quantite}</p>
              <p>Prix : ${c.produits.prix} CFA</p>
              <p>Date : ${c.created_at}</p>
            </div>
          `;
        });
      }
    }

    window.onload = chargerCommandes;
  </script>
</head>
<body>
  <h2>Mes commandes</h2>
  <div id="liste-commandes"></div>
</body>
</html>
